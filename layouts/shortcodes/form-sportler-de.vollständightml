<!-- 
  Sport-Fragebogen — ein spezialisierter Fragebogen für Sportler
  Datenstrom: form-sportler-survey
  
  Dieser Shortcode implementiert das dreistufige Formular für Sportler, das:
  1. Persönliche Daten erfasst
  2. Sport-spezifische Informationen sammelt
  3. Kontaktdaten für die Rücksprache erfasst
  
  Das Formular nutzt das zentrale Spam-Schutz-, Dropdown- und Formularverarbeitungssystem.
-->
<form id="form-sportler-survey" class="sv-multistep-form"
      name="fragebogen-sportler" method="POST"
      data-netlify="true" netlify-honeypot="bot-field">

  <!-- Hidden Fields -->
  <input type="hidden" name="language" value="de">
  <input type="hidden" name="form-name" value="fragebogen-sportler">
  <input type="hidden" name="form_type" value="sportler-survey">
  
  <!-- Spam-Schutz-Felder -->
  {{ partial "spam-protection-fields.html" (dict "FORM_ID" "form-sportler-survey") }}
  
  <!-- Original honeypot field für Netlify -->
  <p class="d-none"><label>Bitte nicht ausfüllen: <input name="bot-field"></label></p>

  <!-- ---------- Schritt 1: Persönliche Daten ---------- -->
  <section id="form-sportler-survey-step-1" class="sv-form-step active" data-step="1">
    <h3 class="sv-step-title mb-4">Schritt 1 von 3: Persönliche Angaben</h3>

    <div class="form-floating sv-form-floating mb-3">
      <input class="form-control" id="form-sportler-survey-vorname"
             name="vorname" placeholder="Vorname *" required>
      <label for="form-sportler-survey-vorname">Vorname *</label>
    </div>

    <div class="form-floating sv-form-floating mb-3">
      <input class="form-control" id="form-sportler-survey-nachname"
             name="nachname" placeholder="Nachname *" required>
      <label for="form-sportler-survey-nachname">Nachname *</label>
    </div>

    <div class="form-floating sv-form-floating mb-3">
      <input class="form-control" id="form-sportler-survey-email" type="email"
             name="email" placeholder="name@example.com" required>
      <label for="form-sportler-survey-email">E-Mail-Adresse *</label>
    </div>

    <div class="form-floating sv-form-floating mb-3">
      <input class="form-control" id="form-sportler-survey-gebjahr"
             name="geburtsjahr" placeholder="Geburtsjahr *" 
             required type="number" min="1900" max="2050">
      <label for="form-sportler-survey-gebjahr">Geburtsjahr *</label>
    </div>

    <p class="sv-tooltip-info mb-2">
      Für diagnostische Zwecke – z.&nbsp;B. Laboruntersuchungen – ist das biologische
      Geschlecht wichtig, unabhängig von Ihrer geschlechtlichen Identität.
    </p>
    
    <!-- Bootstrap Accordion für Geschlecht (Single-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-geschlecht">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-geschlecht">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-geschlecht" 
                  aria-expanded="false" aria-controls="collapse-geschlecht">
            Biologisches Geschlecht *
          </button>
        </h2>
        <div id="collapse-geschlecht" class="accordion-collapse collapse" 
             aria-labelledby="heading-geschlecht" data-bs-parent="#accordion-geschlecht">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="geschlecht" 
                     value="männlich" id="geschlecht1" required>
              <label class="form-check-label" for="geschlecht1">männlich</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="geschlecht" 
                     value="weiblich" id="geschlecht2">
              <label class="form-check-label" for="geschlecht2">weiblich</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="geschlecht" 
                     value="möchte ich nicht angeben" id="geschlecht3">
              <label class="form-check-label" for="geschlecht3">möchte ich nicht angeben</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="sv-form-check-container mb-3">
      <input class="form-check-input" id="form-sportler-survey-dsp1"
             type="checkbox" name="datenschutz1" required>
      <label class="form-check-label" for="form-sportler-survey-dsp1">
        Ich stimme der Datenverarbeitung zu.
      </label>
    </div>

    <div class="d-grid sv-button-container">
      <button type="button" class="btn btn-primary sv-btn-xl" data-next>Weiter</button>
    </div>
  </section>

  <!-- ---------- Schritt 2: Sportliche Aktivität ---------- -->
  <section id="form-sportler-survey-step-2" class="sv-form-step" data-step="2">
    <h3 class="sv-step-title mb-4">Schritt 2 von 3: Sportliche Aktivität</h3>

    <!-- Bootstrap Accordion für Sport-Häufigkeit (Single-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-sportfreq">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-sportfreq">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-sportfreq" 
                  aria-expanded="false" aria-controls="collapse-sportfreq">
            1. Wie häufig treiben Sie Sport?
          </button>
        </h2>
        <div id="collapse-sportfreq" class="accordion-collapse collapse" 
             aria-labelledby="heading-sportfreq" data-bs-parent="#accordion-sportfreq">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="sport_frequency" 
                     value="Täglich" id="freq1">
              <label class="form-check-label" for="freq1">Täglich</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="sport_frequency" 
                     value="Mehrmals pro Woche" id="freq2">
              <label class="form-check-label" for="freq2">Mehrmals pro Woche</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="sport_frequency" 
                     value="Einmal pro Woche" id="freq3">
              <label class="form-check-label" for="freq3">Einmal pro Woche</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="sport_frequency" 
                     value="Gelegentlich" id="freq4">
              <label class="form-check-label" for="freq4">Gelegentlich</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="sport_frequency" 
                     value="Selten bis nie" id="freq5">
              <label class="form-check-label" for="freq5">Selten bis nie</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Accordion für Sportarten (Multiple-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-sportarten">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-sportarten">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-sportarten" 
                  aria-expanded="false" aria-controls="collapse-sportarten">
            2. Welche Sportart betreiben Sie hauptsächlich? (Mehrfachauswahl möglich)
          </button>
        </h2>
        <div id="collapse-sportarten" class="accordion-collapse collapse" 
             aria-labelledby="heading-sportarten" data-bs-parent="#accordion-sportarten">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="sportarten[]" 
                     value="Kraftsport" id="sportart1">
              <label class="form-check-label" for="sportart1">Kraftsport</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="sportarten[]" 
                     value="Ausdauersport" id="sportart2">
              <label class="form-check-label" for="sportart2">Ausdauersport</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="sportarten[]" 
                     value="Teamsport" id="sportart3">
              <label class="form-check-label" for="sportart3">Teamsport</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="sportarten[]" 
                     value="Extremsport" id="sportart4">
              <label class="form-check-label" for="sportart4">Extremsport</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="sportarten[]" 
                     value="Verschiedene" id="sportart5">
              <label class="form-check-label" for="sportart5">Verschiedene</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Accordion für kürzliche Verletzungen (Single-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-recentinj">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-recentinj">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-recentinj" 
                  aria-expanded="false" aria-controls="collapse-recentinj">
            3. Haben Sie in den letzten 12 Monaten Verletzungen erlitten?
          </button>
        </h2>
        <div id="collapse-recentinj" class="accordion-collapse collapse" 
             aria-labelledby="heading-recentinj" data-bs-parent="#accordion-recentinj">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="recent_injuries" 
                     value="Ja, schwere Verletzung (z. B. Bänderriss)" id="recentinj1">
              <label class="form-check-label" for="recentinj1">Ja, schwere Verletzung (z. B. Bänderriss)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="recent_injuries" 
                     value="Ja, mittelschwere Verletzung (z. B. Zerrung)" id="recentinj2">
              <label class="form-check-label" for="recentinj2">Ja, mittelschwere Verletzung (z. B. Zerrung)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="recent_injuries" 
                     value="Ja, leichte Beschwerden (z. B. Muskelkater)" id="recentinj3">
              <label class="form-check-label" for="recentinj3">Ja, leichte Beschwerden (z. B. Muskelkater)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="recent_injuries" 
                     value="Nein" id="recentinj4">
              <label class="form-check-label" for="recentinj4">Nein</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Accordion für frühere Verletzungen (Multiple-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-previnj">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-previnj">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-previnj" 
                  aria-expanded="false" aria-controls="collapse-previnj">
            4. Frühere Verletzungen oder Überlastungsschäden (Mehrfachauswahl möglich)
          </button>
        </h2>
        <div id="collapse-previnj" class="accordion-collapse collapse" 
             aria-labelledby="heading-previnj" data-bs-parent="#accordion-previnj">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="fruehere_verletzungen[]" 
                     value="Knochenbrüche / Gelenkverletzungen" id="previnj1">
              <label class="form-check-label" for="previnj1">Knochenbrüche / Gelenkverletzungen</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="fruehere_verletzungen[]" 
                     value="Muskel- / Sehnenverletzungen" id="previnj2">
              <label class="form-check-label" for="previnj2">Muskel- / Sehnenverletzungen</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="fruehere_verletzungen[]" 
                     value="Chronische Überlastungsbeschwerden" id="previnj3">
              <label class="form-check-label" for="previnj3">Chronische Überlastungsbeschwerden</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="fruehere_verletzungen[]" 
                     value="Andere sportbedingte Probleme" id="previnj4">
              <label class="form-check-label" for="previnj4">Andere sportbedingte Probleme</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Accordion für Körperregionen (Multiple-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-region">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-region">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-region" 
                  aria-expanded="false" aria-controls="collapse-region">
            5. Welche Körperregion belasten Sie am meisten? (Mehrfachauswahl möglich)
          </button>
        </h2>
        <div id="collapse-region" class="accordion-collapse collapse" 
             aria-labelledby="heading-region" data-bs-parent="#accordion-region">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="koerperregionen[]" 
                     value="Rücken" id="region1">
              <label class="form-check-label" for="region1">Rücken</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="koerperregionen[]" 
                     value="Knie / Gelenke" id="region2">
              <label class="form-check-label" for="region2">Knie / Gelenke</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="koerperregionen[]" 
                     value="Schultern / Arme" id="region3">
              <label class="form-check-label" for="region3">Schultern / Arme</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="koerperregionen[]" 
                     value="Muskulatur allgemein" id="region4">
              <label class="form-check-label" for="region4">Muskulatur allgemein</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="koerperregionen[]" 
                     value="Ganzer Körper" id="region5">
              <label class="form-check-label" for="region5">Ganzer Körper</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Accordion für Schmerzen nach Sport (Single-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-pain">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-pain">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-pain" 
                  aria-expanded="false" aria-controls="collapse-pain">
            6. Haben Sie anhaltende Schmerzen nach dem Sport?
          </button>
        </h2>
        <div id="collapse-pain" class="accordion-collapse collapse" 
             aria-labelledby="heading-pain" data-bs-parent="#accordion-pain">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="radio" name="pain_after_sport" 
                     value="Ja, regelmässig" id="pain1">
              <label class="form-check-label" for="pain1">Ja, regelmässig</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="pain_after_sport" 
                     value="Gelegentlich" id="pain2">
              <label class="form-check-label" for="pain2">Gelegentlich</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="pain_after_sport" 
                     value="Nur nach intensiven Einheiten" id="pain3">
              <label class="form-check-label" for="pain3">Nur nach intensiven Einheiten</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="pain_after_sport" 
                     value="Selten bis nie" id="pain4">
              <label class="form-check-label" for="pain4">Selten bis nie</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="radio" name="pain_after_sport" 
                     value="Keine Schmerzen" id="pain5">
              <label class="form-check-label" for="pain5">Keine Schmerzen</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-floating sv-form-floating mb-4">
      <textarea class="form-control" id="form-sportler-survey-freetext"
                name="freitext" style="height:150px"></textarea>
      <label for="form-sportler-survey-freetext">
        Freitext – Was möchten Sie uns sonst noch mitteilen?
      </label>
    </div>

    <div class="d-flex justify-content-between sv-button-container">
      <button type="button" class="btn btn-secondary sv-btn-xl" data-prev>Zurück</button>
      <button type="button" class="btn btn-primary sv-btn-xl" data-next>Weiter</button>
    </div>
  </section>

  <!-- ---------- Schritt 3: Kontaktaufnahme ---------- -->
  <section id="form-sportler-survey-step-3" class="sv-form-step" data-step="3">
    <h3 class="sv-step-title mb-4">Schritt 3 von 3: Kontaktaufnahme</h3>

    <!-- Telefon-Feld mit spezieller Validierung und Formatierung -->
    <div class="form-floating sv-form-floating mb-3">
      <input class="form-control" id="form-sportler-survey-tel"
             name="telefon" type="tel" placeholder="Ihre Telefonnummer" required>
      <label for="form-sportler-survey-tel">Ihre Telefonnummer</label>
    </div>
    <p class="sv-tooltip-info mb-3">
      Bitte Mobilnummer mit Landesvorwahl angeben, z.&nbsp;B. +41 79 123 45 67
    </p>

    <!-- Bootstrap Accordion für Rückrufzeiten (Multiple-Choice) -->
    <div class="accordion sv-form-accordion mb-4" id="accordion-calltime">
      <div class="accordion-item">
        <h2 class="accordion-header" id="heading-calltime">
          <button class="accordion-button collapsed" type="button" 
                  data-bs-toggle="collapse" data-bs-target="#collapse-calltime" 
                  aria-expanded="false" aria-controls="collapse-calltime">
            Bevorzugte Rückrufzeiten (Mehrfachauswahl möglich)
          </button>
        </h2>
        <div id="collapse-calltime" class="accordion-collapse collapse" 
             aria-labelledby="heading-calltime" data-bs-parent="#accordion-calltime">
          <div class="accordion-body">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="rueckruf_zeiten[]" 
                     value="Vormittags (08:00–12:00 Uhr)" id="calltime1">
              <label class="form-check-label" for="calltime1">Vormittags (08:00–12:00 Uhr)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="rueckruf_zeiten[]" 
                     value="Mittags (12:00–14:00 Uhr)" id="calltime2">
              <label class="form-check-label" for="calltime2">Mittags (12:00–14:00 Uhr)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="rueckruf_zeiten[]" 
                     value="Nachmittags (14:00–18:00 Uhr)" id="calltime3">
              <label class="form-check-label" for="calltime3">Nachmittags (14:00–18:00 Uhr)</label>
            </div>
            <div class="form-check">
              <input class="form-check-input" type="checkbox" name="rueckruf_zeiten[]" 
                     value="Abends (18:00–20:00 Uhr)" id="calltime4">
              <label class="form-check-label" for="calltime4">Abends (18:00–20:00 Uhr)</label>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="form-floating sv-form-floating mb-3">
      <textarea class="form-control" id="form-sportler-survey-extra"
                name="zusatzinformationen" style="height:100px"></textarea>
      <label for="form-sportler-survey-extra">
        Zusätzliche Informationen zur Erreichbarkeit (optional)
      </label>
    </div>

    <div class="sv-form-check-container mb-3">
      <input class="form-check-input" id="form-sportler-survey-privacy"
             type="checkbox" name="datenschutz" required>
      <label class="form-check-label" for="form-sportler-survey-privacy">
        Ich stimme der <a href="/privacy">Datenschutzerklärung</a> zu.
      </label>
    </div>

    <div class="d-flex justify-content-between sv-button-container">
      <button type="button" class="btn btn-secondary sv-btn-xl" data-prev>Zurück</button>
      <button type="submit" class="btn btn-primary sv-btn-xl">Absenden</button>
    </div>
  </section>
</form>

<!-- Erfolgsnachricht -->
<div id="form-sportler-survey-success" class="card shadow-sm p-4 mt-4 text-center d-none sv-success-message">
  <h3 class="text-success mb-3"><i class="material-icons">check_circle</i> Vielen Dank für Ihre Anmeldung!</h3>
  <p class="mb-3"><strong>Sie haben uns das Folgende mitgeteilt:</strong></p>
  <div class="text-start" id="form-sportler-survey-summary"></div>
  <hr>
  <p class="lead mt-3" id="form-sportler-survey-emailConfirm"></p>
</div>

<!-- Einbindung der zentralisierten Form-Assets -->
{{ partial "form-assets.html" (dict
  "FormID" "form-sportler-survey"
  "FieldLabels" (dict
    "vorname" "Vorname"
    "nachname" "Nachname"
    "email" "E-Mail"
    "geburtsjahr" "Geburtsjahr"
    "telefon" "Telefon"
    "geschlecht" "Biologisches Geschlecht"
    "sport_frequency" "Sporthäufigkeit"
    "recent_injuries" "Verletzungen in den letzten 12 Monaten"
    "pain_after_sport" "Schmerzen nach dem Sport"
    "sportarten" "Sportarten"
    "fruehere_verletzungen" "Frühere Verletzungen"
    "koerperregionen" "Körperregionen"
    "rueckruf_zeiten" "Rückrufzeiten"
    "freitext" "Freitext"
    "zusatzinformationen" "Zusatzinformationen"
  )
) }}

<!-- Formularspezifisches JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('form-sportler-survey');
  const steps = form.querySelectorAll('.sv-form-step');
  
  // Navigation zwischen Formularschritten
  const show = function(n) { 
    steps.forEach(function(s) { s.classList.remove('active'); });
    steps[n-1].classList.add('active');
    window.scroll({top: form.offsetTop-20, behavior:'smooth'}); 
  };

  // Event-Handler für Weiter-Buttons
  form.querySelectorAll('[data-next]').forEach(function(btn) {
    btn.addEventListener('click', function() {
      const currentStep = btn.closest('.sv-form-step');
      const stepNumber = +currentStep.dataset.step;
      show(stepNumber + 1);
    });
  });

  // Event-Handler für Zurück-Buttons
  form.querySelectorAll('[data-prev]').forEach(function(btn) {
    btn.addEventListener('click', function() {
      const currentStep = btn.closest('.sv-form-step');
      const stepNumber = +currentStep.dataset.step;
      show(stepNumber - 1);
    });
  });

  // Telefonnummer-Formatierung
  const tel = document.getElementById('form-sportler-survey-tel');
  const fmt = function(n) { return n.replace(/\D/g,'').replace(/(\d{3})(\d{3})(\d{2})(\d{2})/,'$1 $2 $3 $4'); };
  
  if (tel) {
    tel.addEventListener('blur', function() {
      const d = tel.value.replace(/\D/g,'');
      if(d.length !== 10 || d[0] !== '0') { 
        alert('Bitte geben Sie eine gültige Telefonnummer mit 10 Ziffern ein.'); 
        tel.value = ''; 
        tel.focus();
      } else {
        tel.value = fmt(d);
      }
    });
  }
  
  // Accordion-Status anzeigen in Accordion-Button
  document.querySelectorAll('.accordion-button').forEach(function(button) {
    const accordionItem = button.closest('.accordion-item');
    const accordionBody = accordionItem.querySelector('.accordion-body');
    
    if (!accordionBody) return;
    
    const checkboxes = accordionBody.querySelectorAll('input[type="checkbox"]');
    const radioButtons = accordionBody.querySelectorAll('input[type="radio"]');
    
    // Funktion zum Aktualisieren des Accordion-Button-Textes basierend auf Auswahl
    const updateButtonText = function() {
      const originalText = button.getAttribute('data-original-text') || button.textContent;
      
      // Wenn keine data-original-text gesetzt ist, speichern wir den ursprünglichen Text
      if (!button.getAttribute('data-original-text')) {
        button.setAttribute('data-original-text', originalText);
      }
      
      let selectedValues = [];
      
      // Checkboxen (Mehrfachauswahl)
      if (checkboxes.length > 0) {
        checkboxes.forEach(function(cb) {
          if (cb.checked) {
            const label = cb.nextElementSibling;
            if (label && label.textContent) {
              selectedValues.push(label.textContent.trim());
            }
          }
        });
      }
      
      // Radiobuttons (Einfachauswahl)
      if (radioButtons.length > 0) {
        radioButtons.forEach(function(rb) {
          if (rb.checked) {
            const label = rb.nextElementSibling;
            if (label && label.textContent) {
              selectedValues.push(label.textContent.trim());
            }
          }
        });
      }
      
      // Text aktualisieren
      if (selectedValues.length > 0) {
        button.innerHTML = originalText + ': <span class="sv-selected-options">' + selectedValues.join(', ') + '</span>';
      } else {
        button.textContent = originalText;
      }
    };
    
    // Event-Listener für Änderungen an Checkboxen und Radiobuttons
    checkboxes.forEach(function(cb) {
      cb.addEventListener('change', updateButtonText);
    });
    
    radioButtons.forEach(function(rb) {
      rb.addEventListener('change', updateButtonText);
    });
    
    // Initialen Status setzen
    updateButtonText();
  });
  
  // Formularübermittlung
  if (typeof window.handleFormSubmit === 'function') {
    window.handleFormSubmit('form-sportler-survey', {
      successElementId: 'form-sportler-survey-success',
      summaryElementId: 'form-sportler-survey-summary',
      emailConfirmElementId: 'form-sportler-survey-emailConfirm'
    });
  } else {
    console.warn('handleFormSubmit function not found. Form submission may not work correctly.');
  }
});
</script>