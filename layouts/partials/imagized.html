{{/*
  This partial expects a dictionary with:
    - context: the parent context (e.g. .)
    - section: the content section to iterate over (e.g. "tests", "locations")
*/}}

<div id="imagized">
  
  
  <style>
    /* Ensure the image container has a relative position */
    .portfolio-box {
      position: relative;
      display: block;
      overflow: hidden;
    }

    /* Ensure uniform height & prevent image stretching */
    .portfolio-box img {
      width: 100%;
      height: 100%;
      object-fit: cover; /* Ensures images fill the space without distortion */
      display: block;
      transition: transform 0.3s ease;
    }

    /* Add zoom effect on hover */
    .portfolio-box:hover img {
      transform: scale(1.05);
    }

    /* Position the overlay text */
    .portfolio-box-caption {
      position: absolute;
      font-family: var(--sv-headings-font-family)!important;
      font-size: 1.2rem;
      font-weight: 800;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(var(--sv-prussianblue-rgb), 0.7);
      color: white;
      display: flex;
      flex-direction: column; /* Forces text elements to stack vertically */
      align-items: center;
      justify-content: center;
      text-align: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    /* Ensure the overlay becomes visible on hover */
    .portfolio-box:hover .portfolio-box-caption {
      opacity: 1;
    }

    .portfolio .container-fluid .portfolio-box .portfolio-box-caption .project-category, 
    .portfolio .container-sm .portfolio-box .portfolio-box-caption .project-category, 
    .portfolio .container-md .portfolio-box .portfolio-box-caption .project-category, 
    .portfolio .container-lg .portfolio-box .portfolio-box-caption .project-category, 
    .portfolio .container-xl .portfolio-box .portfolio-box-caption .project-category, 
    .portfolio .container-xxl .portfolio-box .portfolio-box-caption .project-category {
      font-family: var(--sv-body-font-family)!important;
      font-size: 1rem;
      font-weight: 800;
      color: white;
      text-transform: uppercase;
      display: block; /* Ensures category is treated as a block element */
      margin-bottom: 5px; /* Adds spacing between category and project name */
    }

    .portfolio .container-fluid .portfolio-box .portfolio-box-caption .project-name, 
    .portfolio .container-sm .portfolio-box .portfolio-box-caption .project-name, 
    .portfolio .container-md .portfolio-box .portfolio-box-caption .project-name, 
    .portfolio .container-lg .portfolio-box .portfolio-box-caption .project-name, 
    .portfolio .container-xl .portfolio-box .portfolio-box-caption .project-name, 
    .portfolio .container-xxl .portfolio-box .portfolio-box-caption .project-name {
      font-size: 1.2rem;
      font-weight: 800;
      color: white;
      display: block; /* Ensures project name is treated as a block element */
    }
  </style>




  <div class="container-fluid p-0">
    <div class="row g-0 justify-content-center">
      {{ range sort (where .context.Site.RegularPages "Section" .section) ".Weight" }}
        {{ $page := . }}
        {{ $title := $page.Title }}
        {{ $category := $page.Params.category }}
        {{ $fullsizePath := $page.Params.fullsize }}
        {{ $thumbPath := $page.Params.thumbnail }}

        {{/* Get images from the assets folder */}}
        {{ $fullImg := resources.Get $fullsizePath }}
        {{ $thumbImg := resources.Get $thumbPath }}

        {{/* Ensure images exist before resizing */}}
        {{ if and $fullImg $thumbImg }}
          {{ $resizedFull := $fullImg.Resize "1920x" }}
          {{ $resizedThumb := $thumbImg.Resize "600x" }}
          <div class="col-lg-4 col-md-6 col-sm-12">
            <a class="portfolio-box" href="{{ $resizedFull.RelPermalink | safeURL }}" title="{{ $title | safeHTML }}">
              <img class="img-fluid" src="{{ $resizedThumb.RelPermalink | safeURL }}" alt="{{ with $page.Params.alt }}{{ . | safeHTML }}{{ else }}{{ $title | safeHTML }}{{ end }}" />
              <div class="portfolio-box-caption">
                <div class="project-category text-white-50"><p>{{ $category | safeHTML }}</p></div>

                <div class="project-name"><p>{{ $title | safeHTML }}</p></div>
              </div>
            </a>
          </div>
        {{ end }}
      {{ end }}
    </div>
  </div>
</div>
