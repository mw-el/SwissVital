<script src="{{ "js/form-spam-protection-utils.js" | relURL }}" defer></script>
<script src="{{ "js/form-dropdown-utils.js" | relURL }}" defer></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Spam-Schutz aktivieren
  if (typeof initSpamProtection === 'function') {
    initSpamProtection('{{ .FormID }}');
  }

  // Einheitliche Submission-Logik
  if (typeof handleFormSubmit === 'function') {
    handleFormSubmit('{{ .FormID }}', {
      fieldLabels: {{ .FieldLabels | jsonify }},
      successElementId: '{{ .FormID }}-success',
      summaryElementId: '{{ .FormID }}-summary',
      emailConfirmElementId: '{{ .FormID }}-emailConfirm'
    });
  }
  
  // Dropdowns initialisieren, falls CustomDropdowns Ã¼bergeben wurde
  {{ if .CustomDropdowns }}
    if (typeof initializeDropdown === 'function') {
      {{ range .CustomDropdowns }}
        initializeDropdown('{{ .displayId }}', '{{ .dropdownId }}', '{{ .checkboxName }}', {{ .isSingleChoice }});
      {{ end }}
    }
  {{ end }}
});
</script>